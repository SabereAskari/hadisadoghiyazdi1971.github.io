---
layout: persian
title: "ูพุงุฏูโุณุงุฒ ู ุชุญูู ุงูฺฏูุฑุชู UniForCE"
permalink: /UniForCE_MinimalMistakes_Final.md/
dir: rtl
classes: wide rtl-layout
author_profile: true
description: "ฺฏุฒุงุฑุด ฺฉุงูู ูพุงุฏูโุณุงุฒ UniForCE (DeepSeek-derived)ุ ุดุงูู ฺฉุฏุ ุชูุถุญุงุช ุฎุทโุจูโุฎุทุ ุขุฒูุงุดโูุง ู ููุงุณู ุจุง KMeans."

header:
  overlay_image: "/assets/images/background.jpg"
  overlay_filter: 0.3
  overlay_color: "#5e616c"
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"

toc: true
toc_label: "ููุฑุณุช ูุทุงูุจ"
toc_icon: "list"
toc_sticky: true
---

<div class="english-text">
<strong>
  UniForCE
</strong>
</div>

## ๐ฉโ๐ป ููุณูุฏู

<strong>ููุฏู ูุงุณู</strong>

## ๐ฌ ุฑุงูโูุง ุงุฑุชุจุงุท

<p align="center">
  <a href="https://github.com/mahdiehgh79">
    <img src="https://img.shields.io/badge/GitHub-YourUsername-181717?logo=github&logoColor=white&style=flat-square" />
  </a>
  <a href="mailto:mahdiehghasemi79@gmail.com">
    <img src="https://img.shields.io/badge/Email-your.email%40gmail.com-EA4335?logo=gmail&logoColor=white&style=flat-square" />
  </a>
</p>

<a href="https://www.um.ac.ir/" style="text-decoration:underline; color:green;" target="_blank">
<strong>ุฏุงูุดฺฏุงู ูุฑุฏูุณ ูุดูุฏ</strong>
</a>

# ูพุงุฏูโุณุงุฒ ู ุชุญูู ุงูฺฏูุฑุชู UniForCE โ ูุณุฎูู DeepSeek

**(Unimodal Forest for Clustering and Estimation of k)**

## ููุฑุณุช ูุทุงูุจ

1. [ููุฏูู](#ููุฏูู)
2. [ุชุนุงุฑู ู ูุจุงู ุฑุงุถ](#ุชุนุงุฑู-ู-ูุจุงู-ุฑุงุถ)
3. [ุดุฑุญ ุงูฺฏูุฑุชู (ุดุจูโฺฉุฏ)](#ุดุฑุญ-ุงูฺฏูุฑุชู-ุดุจูโฺฉุฏ)
4. [ูพุงุฏูโุณุงุฒ ุจุง DeepSeek โ ูุงูโูุง ู ฺฉุฏ](#ูพุงุฏูโุณุงุฒ-ุจุง-deepseek--ูุงููุง-ู-ฺฉุฏ)
5. [ูุฑุงุญู ุฎูุดูโุจูุฏ](#ูุฑุงุญู-ุฎูุดูุจูุฏ)
6. [ุชุญูู ุนููฺฉุฑุฏ ูุฑุญููโุจูโูุฑุญูู ุฏุฑ ฺฉุฏ](#ุชุญูู-ุนููฺฉุฑุฏ-ูุฑุญูุจููุฑุญูู-ุฏุฑ-ฺฉุฏ)
7. [ุขุฒูุงุดโูุงุ ูุชุงุฌ ู ููุงุณู ุจุง KMeans](#ุขุฒูุงุดูุง-ูุชุงุฌ-ู-ููุงุณู-ุจุง-kmeans)
8. [ุชุญูู ฺฏุฑุงูฺฉ ูุชุงุฌ](#ุชุญูู-ฺฏุฑุงูฺฉ-ูุชุงุฌ-ุฎูุดูุจูุฏ)
9. [ุฌูุนโุจูุฏ](#ุฌูุนุจูุฏ)
10. [ูุชุฌูโฺฏุฑ ููุง](#ูุชุฌูฺฏุฑ-ููุง)
11. [ูุญููู ุงุฌุฑุง (ุฑุงูููุง)](#ูุญููู-ุงุฌุฑุง-ุฑุงูููุง)
12. [ููุงุจุน](#ููุงุจุน)

---

## ููุฏูู

ุงูฺฏูุฑุชู **UniForCE** (Unimodal Forest for Clustering and Estimation of \(k\)) ฺฉ ุฑูุด ูุจุชู ุจุฑ ุดฺฉู ฺฺฏุงู ุงุณุช ฺฉู ูุฏู ุขู ููโุฒูุงู ุฎูุดูโุจูุฏ ู ุชุฎูู ุฎูุฏฺฉุงุฑ ุชุนุฏุงุฏ ุฎูุดูโูุง ุงุณุช. ูุณุฎูู DeepSeek ฺฉู ููุฑุงู ูพุฑููุฏูู ูพุฑูฺู ุงุฑุณุงู ุดุฏูุ ูพุงุฏูโุณุงุฒโุงโุณุช ุจุฑ ูพุงูู ุณู ุงุฏูู ุงุตู:

- Overclustering: ุชูุณู ุงูููู ูุถุง ุจู ุฒุฑุฎูุดูโูุง ุฒุงุฏ ุจุฑุง ฺฏุฑูุชู ุณุงุฎุชุงุฑ ูุญู ฺฺฏุงู.
- Unimodal pair testing: ุจุฑุฑุณ ุชฺฉโูุฌู ุจูุฏู ุชูุฒุน ุชุฑฺฉุจ ูุฑ ุฒูุฌ ุฎูุดู (ุจุง ุชุตูุฑ ุฑู ูุญูุฑ ูุฑุงฺฉุฒ ู KDE / ุขุฒููู Dip).
- ุณุงุฎุช ุฌูฺฏูู ุชฺฉโูุฌู: ุงูุญุงู ุฎูุดูโูุง ุจุฑ ุงุณุงุณ ุขุฒูููโูุง ู ุงุณุชุฎุฑุงุฌ ุฎูุดูโูุง ููุง (ูุฑ ุฏุฑุฎุช ฺฉ ุฎูุดู).

ูุฏู ุงู ฺฏุฒุงุฑุด: ุงุฑุงุฆูู ูุณุฎูู ุชูุฒุ ูุณุชูุฏุณุงุฒ ฺฉุฏ DeepSeekุ ุชูุถุญ ุฎุทโุจูโุฎุท ู ูุฑุงูู ฺฉุฑุฏู ุฏุณุชูุฑุงูุนูู ุงุฌุฑุง ู ุชุญูู ูุชุงุฌ ุจูโุตูุฑุช ูุงุจู ุชฺฉุฑุงุฑ.

---

## ุชุนุงุฑู ู ูุจุงู ุฑุงุถ

---### ๐ธ **ุชุนุฑู ฑ โ ุฎูุดูู ุชฺฉโูุฌู (Unimodal Cluster)**

ุฏุฑ ูุณุฆููู ุฎูุดูโุจูุฏุ ฺฉ **ุฎูุดูู ุชฺฉโูุฌู** ุจู ูุฌููุนูโุง ุงุฒ ููุงุท ุฏุฑ ูุถุง ูฺฺฏ ฺฏูุชู ูโุดูุฏ ฺฉู ฺฺฏุงู ุฏุงุฏูโูุง ุฏุฑ ุขู ููุท **ฺฉ ููู (mode)** ุฏุงุฑุฏ.

ุจูโุตูุฑุช ุฑุณูุ ุงฺฏุฑ \(C \subseteq X\) ฺฉ ุฒุฑูุฌููุนู ุงุฒ ุฏุงุฏูโูุง ุจุงุดุฏ ู \(f_C(x)\) ฺฺฏุงู ุชุฎูู ููุงุท ุฏุฑ ุขู ูุงุญู ุจุงุดุฏุ ุขูฺฏุงู \(C\) ุฑุง **ุชฺฉโูุฌู** ูโูุงูู ุงฺฏุฑ:

\[
f_C(x) \text{ ุชููุง ฺฉ ููุทูู ุจุดูู (mode) ุฏุงุดุชู ุจุงุดุฏ.}
\]

---

### ๐ธ **ุชุนุฑู ฒ โ ุขุฒููู ุชฺฉโูุฌู ุจูุฏู ุฏู ุฎูุดู (Unimodality Test)**

ุจุฑุง ุฏู ุฎูุดู \(A\) ู \(B\)ุ ุชุฑฺฉุจ ุขูโูุง ุฑุง ุจุฑุฑุณ ูโฺฉูู ุชุง ุจุจูู ุขุง ฺฺฏุงู ุฏุงุฏูโูุง \(A \cup B\) ูููุฒ ุชฺฉโูุฌู ุงุณุช ุง ุฎุฑ:

\[
\text{Unimodal}(A,B) =
\begin{cases}
\text{True}, & \text{ุงฺฏุฑ } f\_{A \cup B} \text{ ููุท ฺฉ ููู ุฏุงุดุชู ุจุงุดุฏ}, \\[4pt]
\text{False}, & \text{ุงฺฏุฑ ุจุด ุงุฒ ฺฉ ููู ุฏุงุดุชู ุจุงุดุฏ.}
\end{cases}
\]

ุจู ุฒุจุงู ุณุงุฏู:

- ุงฺฏุฑ ุชุฑฺฉุจ ุฏู ุฎูุดู ูููุฒ **ฺฉ ููู** ุฏุงุฑุฏุ ุขูโูุง ุฑุง ูโุชูุงู **ุงุฏุบุงู** ฺฉุฑุฏ.
- ุงฺฏุฑ ุชุฑฺฉุจ ุขูโูุง **ฺูุฏ ููู** ุฏุงุฑุฏุ ุจุงุฏ **ุฌุฏุง** ุจูุงููุฏ.

---

### ๐ธ **ุชุนุฑู ณ โ ฺฺฏุงู ุชุฎูู ู ุขุฒููู Dip**

ุจุฑุง ูุญุงุณุจูู ุชุนุฏุงุฏ ูููโูุงุ ุชุงุจุน ฺฺฏุงู ุชุฑฺฉุจ \(f\_{A\cup B}\) ุจุง **ุชุฎูู ฺฺฏุงู ูุณุชูโุง (KDE)** ุจุฑุขูุฑุฏ ูโุดูุฏ.  
ุณูพุณ ุงุฒ **ุขุฒููู Dip** ุจุฑุง ุจุฑุฑุณ ฺฉุชุง ูููโูุง ุงุณุชูุงุฏู ูโฺฉูู.  
ุชูุณุฑ ูุชุฌู ุจู ุตูุฑุช ุฒุฑ ุงุณุช:

\[
p =
\begin{cases}
\geq \alpha, & \text{ุชฺฉโูุฌู (ูุจูู ูุฑุถูู ุตูุฑ)} \\[4pt]
< \alpha, & \text{ฺูุฏูุฌู (ุฑุฏ ูุฑุถูู ุตูุฑ)}
\end{cases}
\]

ุฏุฑ ุงูุฌุง:

- \(p\) ููุฏุงุฑ ุงุญุชูุงู ุขุฒููู Dip ุงุณุช.
- \(\alpha\) ุณุทุญ ูุนูโุฏุงุฑ (ูุซูุงู ฐูซฐฑ ุง ฐูซฐต) ูโุจุงุดุฏ.

---

### ๐ธ **ุชุนุฑู ด โ ุฎูุดูโุจูุฏ ุงููู (Overclustering)**

ุฏุฑ ูุฑุญููู ูุฎุณุช ุงูฺฏูุฑุชูุ ุฏุงุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ **K-Means** ุจุง ุชุนุฏุงุฏ ุฒุงุฏ ุฎูุดูโูุง (\(k_0\)) ุชูุณู ูโุดููุฏ ุชุง ุณุงุฎุชุงุฑูุง ูุญู ุจูโุฎูุจ ูุดุฎุต ุดููุฏ.  
ุณูพุณ ุฏุฑ ูุฑุงุญู ุจุนุฏุ ุฎูุดูโูุง ูุฒุฏฺฉ ุจุง ุขุฒููู ุชฺฉโูุฌู ุงุฏุบุงู ูโุดููุฏ ุชุง ุฎูุดูโูุง ููุง ุดฺฉู ฺฏุฑูุฏ.

---

### ๐ธ **ุชุนุฑู ต โ ุจุฑุขูุฑุฏ ุชุนุฏุงุฏ ุฎูุดูโูุง (k)**

ุชุนุฏุงุฏ ููุง ุฎูุดูโูุง \(k\_{\text{est}}\) ุจุฑุงุจุฑ ุงุณุช ุจุง ุชุนุฏุงุฏ ูุคูููโูุง ููุจูุฏ ุฏุฑ ฺฏุฑุงู ููุง **ุฌูฺฏู ุชฺฉโูุฌู (Unimodality Forest)**:

\[
k\_{\text{est}} = |\text{Components of Forest}|
\]

## ุดุฑุญ ุงูฺฏูุฑุชู (ุดุจูโฺฉุฏ)

```text
INPUT: ุฏุงุฏูโูุง Xุ (ุงุฎุชุงุฑ) k_true
1. Overclustering: ุงุฌุฑุง KMeans ุจุง k0 (k0 >> ุงูุชุธุงุฑ ุจุฑุง k) -> ุจุฎุดโูุง ูุญู
2. ุจุฑุง ูุฑ ุฒูุฌ ุฎูุดู (A,B):
   a. ูพุฑูุฌฺฉุช ููุงุท AโชB ุฑู ูฺฉุชูุฑ c_B - c_A
   b. ุจุฑุขูุฑุฏ ฺฺฏุงู 1D (KDE) ู/ุง ุงูุฌุงู Dip test ุจุฑ ุฑู ุชูุฒุน ูพุฑูฺูโุดุฏู
   c. ุงฺฏุฑ ุชูุฒุน ุชฺฉโูุฌู ุจุงุดุฏ -> ุนูุงูุช Merge(A,B)
3. ุงุนูุงู ุงูุญุงูุงุช (greedy ุง ุจุง ุงูฺฏูุฑุชู ุดุจู Kruskal ุจุง ุดุฑุท unimodal)
4. ุชฺฉุฑุงุฑ ูุฑุงุญู 2โ3 ุชุง ููฺฏุฑุง
OUTPUT: ุจุฑฺุณุจโูุง ููุงุ ููุฑุณุช ุฎูุดูโูุงุ ู ุจุฑุขูุฑุฏ k
```

---

## ูพุงุฏูโุณุงุฒ ุจุง DeepSeek โ ูุงูโูุง ู ฺฉุฏ

> ุฎูุงุตู ู ุชูุฒ ุดุฏู ู ูุงู ูพุงุชูู ููุง `deepseek_uniforce.py` ุจุฑุง ุงุฌุฑุง ุณุฑุนุ ูโุชูุงูุฏ ููู ูุงู ูพุงุชูู ุฑุง ุงุฌุฑุง ฺฉูุฏ (ุฑุงูููุง ุฏุฑ ุจุฎุด ยซูุญููู ุงุฌุฑุงยป)

### ุงุณุชุฎุฑุงุฌู ฺฉูุฏ ุงุฒ ฺฉุฏ

```python
import numpy as np
from scipy.stats import gaussian_kde
from sklearn.cluster import KMeans
from sklearn.metrics import adjusted_rand_score
import matplotlib.pyplot as plt
import pandas as pd
import os

def count_peaks_1d(data_1d, bw_method='scott', grid_points=512):
    data_1d = np.asarray(data_1d)
    if data_1d.size < 5:
        return 1
    kde = gaussian_kde(data_1d, bw_method=bw_method)
    xs = np.linspace(data_1d.min(), data_1d.max(), grid_points)
    ys = kde(xs)
    peaks = 0
    for i in range(1, len(ys)-1):
        if ys[i] > ys[i-1] and ys[i] > ys[i+1]:
            peaks += 1
    return max(1, peaks)

class UniForCE:
    def __init__(self, alpha=0.001, M=25, L=11, k_prime_factor=3):
        self.alpha = alpha
        self.M = M
        self.L = L
        self.k_prime_factor = k_prime_factor

    def overclustering(self, X, k_true=None):
        n = X.shape[0]
        if k_true is None:
            k_prime = min(max(10, n // 10), 50)
        else:
            k_prime = max(10, k_true * self.k_prime_factor)
        km = KMeans(n_clusters=k_prime, random_state=0).fit(X)
        labels = km.labels_
        clusters = []
        for i in range(k_prime):
            pts = X[labels == i]
            if len(pts) >= self.M:
                clusters.append(pts)
        return clusters

    def calculate_signed_distances(self, cluster_i, cluster_j):
        mu_i = cluster_i.mean(axis=0)
        mu_j = cluster_j.mean(axis=0)
        r_ij = mu_j - mu_i
        norm = np.linalg.norm(r_ij)
        if norm < 1e-8:
            return np.zeros(len(np.vstack([cluster_i, cluster_j])))
        midpoint = 0.5 * (mu_i + mu_j)
        combined = np.vstack([cluster_i, cluster_j])
        distances = []
        for p in combined:
            numerator = np.dot(r_ij, p) - np.dot(r_ij, midpoint)
            distances.append(numerator / norm)
        return np.array(distances)

    def unimodal_test(self, cluster_i, cluster_j):
        votes = 0
        n_i, n_j = len(cluster_i), len(cluster_j)
        sample_size = min(n_i, n_j)
        for _ in range(self.L):
            if n_i <= n_j:
                sample_i = cluster_i
                idx = np.random.choice(n_j, sample_size, replace=False)
                sample_j = cluster_j[idx]
            else:
                idx = np.random.choice(n_i, sample_size, replace=False)
                sample_i = cluster_i[idx]
                sample_j = cluster_j
            distances = self.calculate_signed_distances(sample_i, sample_j)
            peaks = count_peaks_1d(distances)
            # Here we use a peaks-based heuristic instead of a dip test for robustness
            if peaks == 1:
                votes += 1
        return votes > (self.L // 2)

    def build_unimodality_forest(self, clusters):
        import networkx as nx
        G = nx.Graph()
        n = len(clusters)
        centers = [c.mean(axis=0) for c in clusters]
        G.add_nodes_from(range(n))
        edges = []
        for i in range(n):
            for j in range(i+1, n):
                dist = np.linalg.norm(centers[i] - centers[j])
                edges.append((i, j, dist))
        edges.sort(key=lambda x: x[2])
        for i, j, d in edges:
            if not nx.has_path(G, i, j):
                if self.unimodal_test(clusters[i], clusters[j]):
                    G.add_edge(i, j, weight=d)
        return G

    def fit(self, X, k_true=None):
        clusters = self.overclustering(X, k_true)
        forest = self.build_unimodality_forest(clusters)
        # extract connected components as final clusters
        import networkx as nx
        labels = -1 * np.ones(len(X), dtype=int)
        final_clusters = []
        for comp_id, comp in enumerate(nx.connected_components(forest)):
            # collect points from constituent overclusters
            pts = np.vstack([clusters[idx] for idx in comp])
            final_clusters.append(pts)
            # Note: mapping back to original indices requires careful bookkeeping;
            # here we assume overclustering preserved original ordering (or use indices)
        k_est = len(final_clusters)
        return {'labels': labels, 'clusters': final_clusters, 'k_estimated': k_est, 'forest': forest}
```

---

## ูุฑุงุญู ุฎูุดูโุจูุฏ

### ฑ) Overclustering (ุฎูุดูโุจูุฏ ุงููู)

- ูุฏู: ุชูุณู ูุถุง ุจู ูุทุนุงุช ูุญู ุชุง ูุฑุฒูุง ฺฺฏุงู ูุญู ุขุดฺฉุงุฑ ุดูุฏ.
- ูพุงุฏูโุณุงุฒ: KMeans ุจุง \(k_0\) ุจุฒุฑฺฏ (ูุซูุงู \(k_0 = \min(\max(10, n/10), 50)\)).
- ูฺฉุชู: ุฎูุดูโูุง ุฎู ฺฉูฺฺฉ ุญุฐู ูโุดููุฏ (ุงูุฏุงุฒูู ุขุณุชุงูู M).

### ฒ) ูุญุงุณุจูู ูุงุตููโูุง ุงูุถุงโุดุฏู ู ูพุฑูุฌฺฉุดู

- ุจุฑุง ุฒูุฌ ุฎูุดูโูุง ุจุฑุฏุงุฑ ุฌูุช \(r\_{ij} = \mu_j - \mu_i\) ูุญุงุณุจู ูโุดูุฏ.
- ููุงุท ุฏู ุฎูุดู ุฑู ุงู ุจุฑุฏุงุฑ ูพุฑูุฌฺฉุช ุดุฏู ู ยซูุงุตููู ุงูุถุง ุดุฏูยป ุจุฑุง ูุฑ ููุทู ูุญุงุณุจู ูโุดูุฏ.
- ุงู ูพุฑูุฌฺฉุดู ูุถุง ุฑุง ุจู ฑ ุจุนุฏ ฺฉุงูุด ูโุฏูุฏ ู ุจุฑุฑุณ ูุฏูุง ุณุงุฏูโุชุฑ ูโุดูุฏ.

### ณ) Unimodal test (ุขุฒููู ุชฺฉโูุฌู)

- ุฏุฑ ูุณุฎูู ุนููุงุช ุงู ฺฏุฒุงุฑุดุ ุจูโุฌุง ุงุณุชูุงุฏูู ูุณุชูู ุงุฒ Dip test (ฺฉู ูพุงุฏูโุณุงุฒ ุขู ููฺฉู ุงุณุช ูุงุฒููุฏ ุจุณุชูโูุง ุฎุงุฑุฌ ุจุงุดุฏ)ุ ุงุฒ ฺฉ ุฑูุด ููุงููโุชุฑ ูุจุชู ุจุฑ KDE ู ุดูุงุฑุด ูููโูุง ุงุณุชูุงุฏู ุดุฏู ุงุณุช.
- ุจุฑุง ูพุงุฏุงุฑุ ุขุฒููู ุฑู ฺูุฏ ูููููู ุชุตุงุฏู (L ุชฺฉุฑุงุฑ) ุงูุฌุงู ูโุดูุฏ ู ุฑุฃ ุงฺฉุซุฑุช ุชุตููโฺฏุฑูุฏู ุงุณุช.

### ด) ุณุงุฎุช ุฌูฺฏู ุชฺฉโูุฌู (Unimodality Forest)

- ุชูุงู ุฒูุฌโูุง ุจุฑ ุงุณุงุณ ูุงุตูู ูุฑุชุจ ูโุดููุฏ (ูุงููุฏ Kruskal).
- ูุฑฺฏุงู ุฒูุฌ ูุงุจู ุงุฏุบุงู ุจุงุดุฏ ู ุงุชุตุงู ุฏุฑ ฺฏุฑุงู ุงุฌุงุฏ ูฺฉูุฏุ ุงู ุจู ฺฏุฑุงู ุงูุฒูุฏู ูโุดูุฏ.
- ุฏุฑ ููุงุช ูููููโูุง ูุชุตู ฺฏุฑุงูุ ุฎูุดูโูุง ููุง ุฑุง ูุดุฎุต ูโฺฉููุฏ.

---

---

## โ๏ธ ุชุญูู ุนููฺฉุฑุฏ ูุฑุญููโุจูโูุฑุญูู ุฏุฑ ฺฉุฏ

1. **Overclustering (ุฎูุดูโุจูุฏ ุงููู):**  
   ุฏุฑ ุงุจุชุฏุง ุงุฌุฑุง ุชุงุจุน `fit()`ุ ุฏุงุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ KMeans ู ุชุนุฏุงุฏ ุฒุงุฏ ุฎูุดูโูุง ุงููู ุชูุณู ูโุดููุฏ.  
   ุงู ูุฑุญูู ุฏุฑ ูุชุฏ `overclustering()` ุงูุฌุงู ูโุดูุฏ ู ูุฏู ุขู ุดูุงุณุง ุฒุฑโุฎูุดูโูุง ูุญู ุจุฑุง ุขูุงุฏฺฏ ุฏุฑ ุงุฏุบุงู ุงุณุช.

2. **ูุญุงุณุจูู ูุงุตููโูุง ุงูุถุงโุดุฏู (Signed Distances):**  
   ุจุฑุง ูุฑ ุฌูุช ุฎูุดูุ ูุงูฺฏูโูุง (`ฮผ_i` ู `ฮผ_j`) ฺฏุฑูุชู ูโุดููุฏ ู ุฏุงุฏูโูุง ุฑู ุฎุท ุจู ุงู ุฏู ูุงูฺฏู ูพุฑูุฌฺฉุช ูโุดููุฏ.  
   ุงู ูุฑุญูู ุฏุฑ `calculate_signed_distances()` ุงูุฌุงู ูโฺฏุฑุฏ.

3. **ุขุฒููู ุชฺฉโูุฌู (Unimodal Test):**  
   ุชุงุจุน `unimodal_test()` ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุชุฑฺฉุจ ุฏู ุฎูุดู ุฏุงุฑุง ฺฉ ููู ุฏุฑ ุชูุฒุน ฺฺฏุงู ุงุณุช ุง ุฎุฑ.  
   ุงฺฏุฑ ุชูุฒุน ุชฺฉโูููโุง ุจุงุดุฏุ ุฏู ุฎูุดู ุจูโุนููุงู ูุดุงุจู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดููุฏ.

4. **ุณุงุฎุช ุฌูฺฏู ุชฺฉโูุฌู (Unimodality Forest):**  
   ูุชุฏ `build_unimodality_forest()` ุจุง ุงููุงู ุงุฒ ุงูฺฏูุฑุชู Kruskal ฺฉ ฺฏุฑุงู ุงุฒ ุฑูุงุจุท ุจู ุฎูุดูโูุง ูโุณุงุฒุฏ.  
   ุงูโูุง ฺฉู ุงุฒ ุขุฒููู ุชฺฉโูุฌู ุนุจูุฑ ฺฉุฑุฏูโุงูุฏุ ุฎูุดูโูุง ูุงุจูโุงุฏุบุงู ุฑุง ุจู ูู ูุตู ูโฺฉููุฏ.

5. **ุงุฏุบุงู ุฎูุดูโูุง ู ุชุฎูู ููุง k:**  
   ุฏุฑ ุงูุชูุง ุชุงุจุน `fit()`ุ ูุคูููโูุง ูุชุตู ฺฏุฑุงู ุงุณุชุฎุฑุงุฌ ุดุฏู ู ูุฑฺฉุฏุงู ุจูโุนููุงู ฺฉ ุฎูุดูู ููุง ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดููุฏ.  
   ุชุนุฏุงุฏ ุฎูุดูโูุง (`k_estimated`) ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฒ ุณุงุฎุชุงุฑ ฺฏุฑุงู ุจูโุฏุณุช ูโุขุฏ.

---

## ุขุฒูุงุดโูุงุ ูุชุงุฌ ู ููุงุณู ุจุง KMeans

<div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
    <img src="C:\Users\user\Desktop\uniforcenew\blobs_3_comparison" alt="IPS1" style="width: 50%; height: 50%; object-fit: contain;">
    <img src="C:\Users\user\Desktop\uniforcenew\blobs_5_comparison" alt="IPS1" style="width: 50%; height: 50%; object-fit: contain;">
    <img src="C:\Users\user\Desktop\uniforcenew\iris_comparison" alt="IPS1" style="width: 50%; height: 50%; object-fit: contain;">
    <img src="C:\Users\user\Desktop\uniforcenew\moons_comparison" alt="IPS1" style="width: 50%; height: 50%; object-fit: contain;">

</div>

### ูุฌููุนูโุฏุงุฏูโูุง ูพุดููุงุฏ ุจุฑุง ุขุฒูุงุด

- Blobs (k=3) โ ุฎูุดูโูุง ฺฏุงูุณ ุฌุฏุง
- Moons (k=2) โ ุณุงุฎุชุงุฑ ููุงู
- Circles (k=2) โ ุญูููโุง
- Irregular (k=4) โ ุฎูุดูโูุง ูุงููุธู ุจุง ูุงุฑุงูุณ ูุชูุงูุช

### ูุนุงุฑูุง ุงุฑุฒุงุจ ูพุดููุงุฏ

- Adjusted Rand Index (ARI)
- Normalized Mutual Information (NMI)
- Silhouette Score

---

## ๐ ุฌุฏูู ุฎูุงุตูู ูุชุงุฌ ุงุฌุฑุง ุงูฺฏูุฑุชูโูุง

| Dataset | n_samples | true_k | uf_k | uf_ARI | km_ARI |
| ------- | --------- | ------ | ---- | ------ | ------ |
| blobs_3 | 300       | 3      | 5    | 0.8754 | 0.9703 |
| blobs_5 | 500       | 5      | 6    | 0.8918 | 0.9516 |
| moons   | 300       | 2      | 10   | 0.2216 | 0.2475 |
| iris    | 150       | 3      | 2    | 0.5584 | 0.7163 |

๐น ุดุงุฎุต **ARI (Adjusted Rand Index)** ูุดุงูโุฏููุฏูู ุดุจุงูุช ุจู ุฎูุดูโุจูุฏ ูพุดโุจูโุดุฏู ู ุจุฑฺุณุจโูุง ูุงูุน ุงุณุช:

- ููุฏุงุฑ **ฑ** ูุดุงูโุฏููุฏูู ุชุทุงุจู ฺฉุงูู ุงุณุช.
- ููุฏุงุฑ ูุฒุฏฺฉ ุจู **ฐ** ุนู ุนููฺฉุฑุฏ ูุดุงุจู ุชุตุงุฏู ุงุณุช.
- ููุฏุงุฑ ููู ุนู ุนููฺฉุฑุฏ ุถุนูโุชุฑ ุงุฒ ุชุตุงุฏู.

---

## ๐ ุชุญูู ุฌุฏูู ูุชุงุฌ

- **blobs_3** โ UniForCE ุชุนุฏุงุฏ ุฎูุดูโูุง ุฑุง ฺฉู ุจุดโุจุฑุขูุฑุฏ ฺฉุฑุฏู ุงุณุช (ต ุจูโุฌุง ณ) ุงูุง ุฏูุช ูุงุจูโูุจูู ุฏุงุฑุฏ (ARIโ0.875).
- **blobs_5** โ ุนููฺฉุฑุฏ ุนุงูุ ููุท ฺฉ ุฎูุดูู ุงุถุงู ุชุดุฎุต ุฏุงุฏู ุดุฏู ุงุณุช (ARIโ0.892).
- **moons** โ ุณุงุฎุชุงุฑ ุบุฑุฎุท ุจุงุนุซ ุฎุทุง ุฒุงุฏ ุฏุฑ ุชูฺฉฺฉ ุฎูุดูโูุง ุดุฏู (ARIโ0.22).
- **iris** โ ฺฉ ุงุฒ ุฎูุดูโูุง ุจุง ุฏฺฏุฑ ุงุฏุบุงู ุดุฏู ู ุชุนุฏุงุฏ ุชุฎููโุฒุฏูโุดุฏู ฺฉูุชุฑ ุงุณุช (ฒ ุจูโุฌุง ณ).

---

## ๐งฉ ุชุญูู ฺฏุฑุงูฺฉ ูุชุงุฌ ุฎูุดูโุจูุฏ

### ๐ ูุฌููุนูโุฏุงุฏูู blobs_3

|              ุจุฑฺุณุจ ูุงูุน               |              UniForCE               |              KMeans               |
| :------------------------------------: | :---------------------------------: | :-------------------------------: |
| ![True labels](blobs_3_comparison.png) | ![UniForCE](blobs_3_comparison.png) | ![KMeans](blobs_3_comparison.png) |

ุฏุฑ ุงู ุขุฒูุงุดุ ุณู ุฎูุดูู ูุงูุน ุจุง ูพูุฌ ุฎูุดูู ุชุฎููโุฒุฏูโุดุฏู ุชูุณุท UniForCE ููุงุณู ุดุฏูโุงูุฏ.  
ุงูฺฏูุฑุชู ุจุง ูุฌูุฏ ุจุดโุฎูุดูโุจูุฏุ ุณุงุฎุชุงุฑ ุงุตู ุฑุง ุจูโุฏุฑุณุช ุชุดุฎุต ุฏุงุฏู ู ูุฑุฒูุง ุฑุง ูุณุจุชุงู ุฎูุจ ุญูุธ ฺฉุฑุฏู ุงุณุช.  
ุฏูู ุงุฌุงุฏ ฺูุฏ ุฎูุดูู ุงุถุงูุ ูุฑุญููู **Overclustering** ุงููู ู ุฏูุช ูุญุฏูุฏ ุฏุฑ ุงุฏุบุงู ููุง ุฎูุดูโูุง ุงุณุช.

---

### ๐ ูุฌููุนูโุฏุงุฏูู blobs_5

|              ุจุฑฺุณุจ ูุงูุน               |              UniForCE               |              KMeans               |
| :------------------------------------: | :---------------------------------: | :-------------------------------: |
| ![True labels](blobs_5_comparison.png) | ![UniForCE](blobs_5_comparison.png) | ![KMeans](blobs_5_comparison.png) |

ุฏุฑ ุฏุงุฏูู ูพูุฌโุฎูุดูโุงุ UniForCE ุจุง ุฏูุช ุจุงูุง ุฎูุดูโูุง ุฑุง ุจุงุฒุงุจ ฺฉุฑุฏู ุงุณุช.  
ุชูุงูุช ุงูุฏฺฉ ุฏุฑ ARI (ฐ.89 ุฏุฑ ุจุฑุงุจุฑ ฐ.95) ูุดุงูโุฏููุฏูู ูุฒุฏฺฉ ุนููฺฉุฑุฏ ุจู KMeans ุงุณุชุ  
ุฏุฑ ุญุงู ฺฉู UniForCE **ุชุนุฏุงุฏ ูุงูุน ุฎูุดูโูุง ุฑุง ููโุฏุงูุณุช**.

## ๐ธ ูุฌููุนูโุฏุงุฏูู _iris_

|        ุจุฑฺุณุจ ูุงูุน        |        UniForCE        |   KMeans (true k)    |
| :-----------------------: | :--------------------: | :------------------: |
| ![True labels](22211.jpg) | ![UniForCE](22211.jpg) | ![KMeans](22211.jpg) |

ุฏุฑ ุขุฒูุงุด ุงูุฌุงูโุดุฏู ุฑู ุฏุงุฏูู **iris**ุ ุงูฺฏูุฑุชู UniForCE ุจุง ููุฏุงุฑ \( k = 2 \) ุจู ฺฉุงุฑ ฺฏุฑูุชู ุดุฏู ู ุดุงุฎุต ุดุจุงูุช **ARI = 0.558** ุจูโุฏุณุช ุขูุฏู ุงุณุชุ ุฏุฑ ุญุงูโฺฉู ุงูฺฏูุฑุชู KMeans ุจุง ุงุทูุงุน ุงุฒ ุชุนุฏุงุฏ ูุงูุน ุฎูุดูโูุง \( k = 3 \)ุ ููุฏุงุฑ **ARI = 0.716** ุฑุง ฺฉุณุจ ฺฉุฑุฏู ุงุณุช.

- **UniForCE** ุชูุงูุณุชู ุงุณุช ุฏู ุจุฎุด ุงุตู ุฏุงุฏู ุฑุง ุจูโุฎูุจ ุงุฒ ูู ุฌุฏุง ฺฉูุฏุ ฺฏุฑฺู ุจู ุฏูู ุงูุชุฎุงุจ \( k=2 \)ุ ฺฉ ฺฉูุงุณ ุงุฒ ุฏุงุฏูโูุง Iris ุจูโุตูุฑุช ุชุฑฺฉุจ ุดูุงุณุง ุดุฏู ุงุณุช.
- **KMeans** ุจุง ุฏุงูุณุชู ุชุนุฏุงุฏ ูุงูุน ุฎูุดูโูุง ุนููฺฉุฑุฏ ุฏููโุชุฑ ุฏุงุฑุฏ ู ุณู ฺฏุฑูู ูุณุจุชุงู ููุณุฌู ุฑุง ุจุงุฒุณุงุฒ ฺฉุฑุฏู ุงุณุช.
- ุชูุงูุช ุฏุฑ **ARI** ูุดุงู ูโุฏูุฏ ฺฉู UniForCE ุจุง ูุฌูุฏ ูุฏุงุดุชู ุงุทูุงุน ุงุฒ ุชุนุฏุงุฏ ุฎูุดูโูุงุ ุณุงุฎุชุงุฑ ฺฉู ุฏุงุฏู ุฑุง ุจูโุฏุฑุณุช ุจุงุฒููุง ฺฉุฑุฏู ู ุงุฒ ูุธุฑ ฺฉูุช ุชูฺฉฺฉุ ูุณุจุชุงู ูุฒุฏฺฉ ุจู KMeans ุนูู ฺฉุฑุฏู ุงุณุช.

๐ฃ **ุฌูุนโุจูุฏ:**  
UniForCE ุฏุฑ ุฏุงุฏูโูุง ูุณุจุชุงู ุฎุท ูุงููุฏ Irisุ ุงฺฏุฑฺู ุฎูุดูโูุง ุฑุง ุจูโุตูุฑุช ูุญุฏูุฏุชุฑ ุงุฏุบุงู ูโฺฉูุฏุ ุงูุง ุณุงุฎุชุงุฑ ุงุตู ุฑุง ุจุฏูู ุงูุช ุฌุฏ ุฏุฑ ุฏูุช ุญูุธ ูโฺฉูุฏ.

---

## ๐ ูุฌููุนูโุฏุงุฏูู _moons_

|        ุจุฑฺุณุจ ูุงูุน        |        UniForCE        |   KMeans (true k)    |
| :-----------------------: | :--------------------: | :------------------: |
| ![True labels](22212.jpg) | ![UniForCE](22212.jpg) | ![KMeans](22212.jpg) |

ุฏุฑ ูุฌููุนูโุฏุงุฏูู **moons**ุ ุงูฺฏูุฑุชู UniForCE ุจุง ููุฏุงุฑ \( k = 10 \) ุงุฌุฑุง ุดุฏู ู ููุฏุงุฑ **ARI = 0.222** ุฑุง ุญุงุตู ฺฉุฑุฏู ุงุณุชุ ุฏุฑ ุญุงูโฺฉู KMeans ุจุง ุงุทูุงุน ุงุฒ ุชุนุฏุงุฏ ูุงูุน ุฎูุดูโูุงุ ููุฏุงุฑ **ARI = 0.247** ุฑุง ฺฉุณุจ ฺฉุฑุฏู ุงุณุช.

- **UniForCE** ุฏุฑ ุงู ุฏุงุฏูู ุบุฑุฎุท ุชูุงูุณุชู ุงุณุช ุณุงุฎุชุงุฑ ุฎูุฏูู ุฏู ููโูุงู ุฑุง ุชุง ุญุฏ ุดูุงุณุง ฺฉูุฏุ ุงูุง ุจูโุฏูู ุฎุงุตุช Overclustering ุงูููุ ุจุฎุดโูุง ุงุฒ ูุฑ ุฎูุดู ุฑุง ุจู ฺูุฏ ุฒุฑุฎูุดู ุชูุณู ฺฉุฑุฏู ุงุณุช.
- **KMeans** ูุฒ ุจูโุฏูู ูุฑุถ ุฎูุดูโูุง ฺฉุฑูุ ุฏุฑ ุฏุงุฏูโูุง ุบุฑุฎุท ุนููฺฉุฑุฏ ฺูุฏุงู ุจูุชุฑ ูุฏุงุฑุฏ ู ุจุฎุดโูุง ุงุฒ ุณุงุฎุชุงุฑ ุฑุง ุงุดุชุจุงู ุจุฑุขูุฑุฏ ูโฺฉูุฏ.
- ุงุฎุชูุงู ุงูุฏฺฉ ARI ุจู ุฏู ุฑูุด ูุดุงู ูโุฏูุฏ ฺฉู ูุฑ ุฏู ุฏุฑ ฺูู ุฏุงุฏูโูุง ุจุง ฺุงูุด ูุดุงุจู ุฑูุจูโุฑู ูุณุชูุฏ.
  ๐ฃ **ุฌูุนโุจูุฏ:**  
  ุฏุฑ ุฏุงุฏูโูุง ุบุฑุฎุท ูุงููุฏ moonsุ UniForCE ุจุง ูุฌูุฏ overclusteringุ ุนููฺฉุฑุฏ ูุฒุฏฺฉ ุจู KMeans ุฏุงุฑุฏ ู ุฏุฑ ุจุงุฒุณุงุฒ ุณุงุฎุชุงุฑ ุฎูุฏู ุฏุงุฏู ููููโุชุฑ ุงุฒ ุงูฺฏูุฑุชูโูุง ุตุฑูุงู ุฎุท ุนูู ูโฺฉูุฏ.

---

## ๐ง ุฌูุนโุจูุฏ

| ูฺฺฏ                                            | ุชูุถุญ                                                     |
| ------------------------------------------------ | --------------------------------------------------------- |
| **ุชุฎูู ุฎูุฏฺฉุงุฑ k**                               | ูุงุฒ ุจู ุชุนู ุชุนุฏุงุฏ ุฎูุดูโูุง ูพุด ุงุฒ ุงุฌุฑุง ูุณุช.            |
| **ูพุงูโฺฏุฐุงุฑ ุขูุงุฑ ูุจุชู ุจุฑ ุชฺฉโูุฌู ุจูุฏู ุชูุฒุน** | ุจู ุฌุง ูุงุตููู ุงููุฏุณ ุตุฑูุ ุงุฒ ุชุญูู ฺฺฏุงู ุงุณุชูุงุฏู ูโฺฉูุฏ. |
| **ุนููฺฉุฑุฏ ูู ุฏุฑ ุฏุงุฏูโูุง ฺฏุงูุณ ู ุฎูุดโุณุงุฎุชุงุฑ**    | ุจูโูฺู ุฏุฑ ูุฌููุนูโูุง Blobs.                              |
| **ุถุนู ุฏุฑ ุณุงุฎุชุงุฑูุง ุบุฑุฎุท**                      | ุฏุฑ ุฏุงุฏูโูุง ุฎูุฏู (ูุซู Moons) ุนููฺฉุฑุฏ ฺฉุงูุด ูโุงุจุฏ.        |

---

## ๐ฌ ูุชุฌูโฺฏุฑ ููุง

ุงูฺฏูุฑุชู **UniForCE** ฺฉ ฺุงุฑฺูุจ ูุจุชู ุจุฑ ุขุฒูููโูุง ฺฺฏุงู ุจุฑุง ุงุฏุบุงู ุฎูุดูโูุง ุงุณุช ฺฉู:

- ุจุฏูู ุงุทูุงุน ุงุฒ ุชุนุฏุงุฏ ุฎูุดูโูุง (`k`) ูุงุฏุฑ ุจู ุชุฎูู ุขู ุงุณุชุ
- ุฏุฑ ุฏุงุฏูโูุง ุฏุงุฑุง ุณุงุฎุชุงุฑ ฺฺฏุงู ูุงุถุญ ุนููฺฉุฑุฏ ูุฒุฏฺฉ ุจู KMeans ุฏุงุฑุฏุ
- ู ูโุชูุงูุฏ ุจู ุนููุงู ฺฏุงู ูุงู ุจุฑุง ุงูฺฏูุฑุชูโูุง ูพฺุฏูโุชุฑ (ูุงููุฏ HDBSCAN ุง Spectral Clustering) ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑุฏ.

---

## ูุญููู ุงุฌุฑุง (ุฑุงูููุง)

1. ูุตุจ ูพุดโูุงุฒูุง:

```bash
pip install numpy scipy scikit-learn matplotlib pandas networkx
```

2. ุงุฌุฑุง ูุณุฎูู ูพุงุชูู ุขูุงุฏู (`deepseek_uniforce.py`):

```bash
python deepseek_uniforce.py --output "C:\Users\user\Desktop\uniforcenew"
```

3. ูพุณ ุงุฒ ุงุฌุฑุงุ ูุงูโูุง ุฎุฑูุฌ ุฏุฑ ูพูุดูู ูุดุฎุตโุดุฏู ูุฑุงุฑ ูโฺฏุฑูุฏ:

- ุชุตุงูุฑ ููุงุณูโุง: `*_comparison.png`
- ุฌุฏูู ูุชุงุฌ: `uniforce_results.csv`

---

## ููุงุจุน

1. Klemelรค, J. (2024). _UniForCE: Unimodal Forest method for Clustering and Estimation of the number of clusters._
2. MacQueen, J. (1967). _Some methods for classification and analysis of multivariate observations._

---
