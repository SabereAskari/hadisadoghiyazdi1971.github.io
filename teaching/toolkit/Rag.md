---
layout: persian  # ุง single ุจุง ฺฉูุงุณ rtl-layout
classes: wide rtl-layout
dir: rtl
title: "ุชููุฏ ุชููุชโุดุฏู ุจุง ุจุงุฒุงุจ"
permalink: /teaching/studenteffort/toolkit/rag/
author_profile: false
sidebar:
  nav: "toolkit"
header:
  overlay_image: "/assets/images/background.jpg"
  overlay_filter: 0.3
  overlay_color: "#5e616c"
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
---



# RAG: ุชููุฏ ุชููุชโุดุฏู ุจุง ุจุงุฒุงุจ

**RAG** ุง **Retrieval-Augmented Generation** ฺฉ ูุนูุงุฑ ูพุดุฑูุชู ุฏุฑ ุญูุฒูโ ููุด ูุตููุน ู ูพุฑุฏุงุฒุด ุฒุจุงู ุทุจุน (NLP) ุงุณุช ฺฉู ุจุฑุง ุจูุจูุฏ ฺฉูุช ู ุฏูุช ูุฏูโูุง ุชููุฏ ุฒุจุงู (ูุงููุฏ ฺุชโุจุงุชโูุง) ุทุฑุงุญ ุดุฏู ุงุณุช.

## ูุดฺฉู ุงุตู: ูุฐูโฺฏู (Hallucination)
ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLMs) ฺฏุงู ุงููุงุช ุงุทูุงุนุงุช ูุงุฏุฑุณุช ุง ุณุงุฎุชฺฏ ุชููุฏ ูโฺฉููุฏุ ฺุฑุง ฺฉู ุฏุงูุด ุขูโูุง ุชููุง ุจู ุฏุงุฏูโุง ฺฉู ุจุง ุขู ุขููุฒุด ุฏุฏูโุงูุฏ ูุญุฏูุฏ ุงุณุช ู ุจู ููุงุจุน ุฎุงุฑุฌ ุฏุณุชุฑุณ ูุฏุงุฑูุฏ.

## ุฑุงูโุญู RAG: ุชุฑฺฉุจ ุจุงุฒุงุจ ู ุชููุฏ

RAG ุงู ูุดฺฉู ุฑุง ุจุง ุฏู ูุฑุญูู ุงุตู ุญู ูโฺฉูุฏ:

1.  **ุจุงุฒุงุจ (Retrieval):**
    *   ุณูุงู ฺฉุงุฑุจุฑ ุฏุฑุงูุช ูโุดูุฏ.
    *   ุณุณุชู ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ููุชูุฑ ุฌุณุชุฌู (ูุซูุงู ุจุฑุฏุงุฑุดูุงุณ ุง Vector Search)ุ ูุฑุชุจุทโุชุฑู ุงุณูุงุฏ ู ุงุทูุงุนุงุช ุฑุง ุงุฒ ฺฉ ูพุงฺฏุงู ุฏุงูุด ุฎุงุฑุฌ (ูุซู ูพุงฺฏุงู ุฏุงุฏูุ ูฺฉโูพุฏุงุ ุงุณูุงุฏ ุฏุงุฎู ุดุฑฺฉุช ู...) ูพุฏุง ูโฺฉูุฏ.

2.  **ุชููุฏ ุชููุชโุดุฏู (Augmented Generation):**
    *   ุงุทูุงุนุงุช ุจุงุฒุงุจโุดุฏู ุจู ููุฑุงู ุณูุงู ุงุตู ฺฉุงุฑุจุฑุ ุจู ุนููุงู **"ุฒููู" (Context)** ุจู ูุฏู ุฒุจุงู ุงุฑุงุฆู ูโุดูุฏ.
    *   ุงุฒ ูุฏู ุฎูุงุณุชู ูโุดูุฏ ุชุง ูพุงุณุฎ ุชููุฏ ฺฉูุฏ ฺฉู **ูู ุจุฑ ุงุณุงุณ ุฏุงูุด ุงุฒ ูพุด ุขููุฎุชูโุดุฏูโ ุฎูุฏุด ู ูู ุจุฑ ุงุณุงุณ ุงุณูุงุฏ ุงุฑุงุฆูโุดุฏู** ุจุงุดุฏ.

## ูุฒุงุง ฺฉูุฏ

*   **ุฏูุช** ูพุงุณุฎโูุง ูุจุชู ุจุฑ ุญูุงู ู ูุณุชูุฏุงุช ูุณุชูุฏ.
*   **ุจูโุฑูุฒุฑุณุงู ุขุณุงู:** ุจุฑุง ุจูโุฑูุฒุฑุณุงู ุฏุงูุด ูุฏูุ ููุท ฺฉุงู ุงุณุช ูพุงฺฏุงู ุฏุงูุด ุฑุง ุชุบุฑ ุฏูุฏ (ูุงุฒ ุจู ุขููุฒุด ูุฌุฏุฏ ูุฏู ูุณุช).
*   **ุดูุงูุช:** ูโุชูุงู ููุจุน ุงุทูุงุนุงุช ฺฉู ูพุงุณุฎ ุจุฑ ุงุณุงุณ ุขู ุชููุฏ ุดุฏู ุฑุง ุฑุฏุงุจ ฺฉุฑุฏ.
*   **ฺฉุงูุด ูุฐูโฺฏู:** ุงุญุชูุงู ุณุงุฎุช ุงุทูุงุนุงุช ุบุฑูุงูุน ุจู ุดุฏุช ฺฉุงูุด ูโุงุจุฏ.

## ฺฉุงุฑุจุฑุฏูุง

*   ฺุชโุจุงุชโูุง ูพุดุชุจุงู ูุดุชุฑ
*   ุณุณุชูโูุง ูพุฑุณุด ู ูพุงุณุฎ (Q&A)
*   ุฎูุงุตูโุณุงุฒ ุงุณูุงุฏ ุชุฎุตุต
*   ุฏุณุชุงุฑูุง ููุดููุฏ ุจุฑ ุงุณุงุณ ุฏุงุฏูโูุง ุฏุงุฎู ุณุงุฒูุงู

## FAISS ฺุณุชุ ฺฉ ุฑุงูููุง ฺฉุงูู

## ูุนุฑู ฺฉู
 
<a href="https://fa.wikipedia.org/wiki/%D9%BE%D8%A7%DB%8C%DA%AF%D8%A7%D9%87_%D8%AF%D8%A7%D8%AF%D9%87_%D8%A8%D8%B1%D8%AF%D8%A7%D8%B1%DB%8C#:~:text=FAISS%3A%20%DA%A9%D8%AA%D8%A7%D8%A8%D8%AE%D8%A7%D9%86%D9%87%E2%80%8C%D8%A7%DB%8C%20%D9%85%D9%86%D8%A8%D8%B9%E2%80%8C%D8%A8%D8%A7%D8%B2%20%DA%A9%D9%87%20%D8%AA%D9%88%D8%B3%D8%B7,%D8%AD%D8%AC%D9%85%20%D8%A8%D8%A7%D9%84%D8%A7%20%D8%B7%D8%B1%D8%A7%D8%AD%DB%8C%20%D8%B4%D8%AF%D9%87%20%D8%A7%D8%B3%D8%AA." style="text-decoration:none; color:green;" target="_blank">
      <strong>FAISS</strong>
    </a> (ูุฎูู Facebook AI Similarity Search) ฺฉ ฺฉุชุงุจุฎุงูู ุงููพูโุณูุฑุณ ุงุณุช ฺฉู ุชูุณุท ุชู AI Research ูุณุจูฺฉ (ูุชุง) ุชูุณุนู ุฏุงุฏู ุดุฏู ุงุณุช. ุงู ฺฉุชุงุจุฎุงูู ุจุฑุง **ุฌุณุชุฌู ุดุจุงูุช ุจุฑุฏุงุฑูุง** (Vector Similarity Search) ุจูููโุณุงุฒ ุดุฏู ุงุณุช.

ุงุจุชุฏุง ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุจุญุซ ู ฺฉูู 


ูพุงฺฏุงูโูุง ุฏุงุฏู ุจุฑุฏุงุฑุ ูุณู ุฌุฏุฏ ุงุฒ ุณุณุชูโูุง ุฐุฎุฑูโุณุงุฒ ูุณุชูุฏ ฺฉู ูู ุชููุง ุฏุงุฏูโูุง ุฑุง ูฺฏูุฏุงุฑ ูโฺฉููุฏุ ุจูฺฉู **ูุนูุง ู ุฑุงุจุทู** ุจู ุขูโูุง ุฑุง ูุฒ ุฏุฑฺฉ ูโฺฉููุฏ. ุงู ููุงูุฑ ุฏุฑ ููุจ ุชุญููุงุช ููุด ูุตููุนุ ุจูโูฺู ุฏุฑ ฺฉุงุฑ ุจุง ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLM) ู ุฏุงุฏูโูุง ุจุฏูู ุณุงุฎุชุงุฑ (ูุงููุฏ ูุชูุ ุชุตูุฑ ู ุตุฏุง) ูุฑุงุฑ ุฏุงุฑุฏ. ุจุฑุฎูุงู ูพุงฺฏุงูโูุง ุฏุงุฏู ุณูุช (SQL) ฺฉู ุจุฑ ุชุทุงุจู ุฏูู ุฏุฑ ุฏุงุฏูโูุง ุณุงุฎุชุงุฑุงูุชู ุชฺฉู ุฏุงุฑูุฏุ ูพุงฺฏุงูโูุง ุฏุงุฏู ุจุฑุฏุงุฑ ุงูฺฉุงู ุฌุณุชุฌู ุจุฑ ุงุณุงุณ **ุดุจุงูุช ูุนูุง** ุฑุง ูุฑุงูู ูโฺฉููุฏ.

**ฺุฑุง ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑุ ูุดฺฉู ฺุณุชุ**
ุฏุฑ ฺฉ ูพุงฺฏุงู ุฏุงุฏู ุณูุชุ ุงฺฏุฑ ุฏุงุฏูโูุง ุจู ุตูุฑุช ุจุฑุฏุงุฑ (ุชุนุจู ุง Embedding) ุฐุฎุฑู ุดููุฏุ ุงูุฌุงู ฺฉ ุฌุณุชุฌู ุณุงุฏู (ูุซูุงู ุงูุชู ูุดุงุจูโุชุฑู ุขุชู) ุจู ุฏูู ุฏู ฺุงูุด ุงุตู ุจุณุงุฑ ูุงฺฉุงุฑุขูุฏ ุฎูุงูุฏ ุจูุฏ:
1.  **ุงุจุนุงุฏ ุจุงูุง:** ุจุฑุฏุงุฑูุง ุงุบูุจ ุตุฏูุง ุง ูุฒุงุฑุงู ุจุนุฏ ุฏุงุฑูุฏ ู ููุงุณู ุขูโูุง ูพุฑูุฒูู ุงุณุช.
2.  **ููุงุณโูพุฐุฑ:** ูุญุงุณุจู ุดุจุงูุช ุจู ฺฉ ุจุฑุฏุงุฑ ูพุฑุณโูุฌู ู ููููโูุง ุจุฑุฏุงุฑ ุฐุฎุฑูโุดุฏูุ ุงุฒ ุชูุงู ูพุงฺฏุงูโูุง ุณูุช ุฎุงุฑุฌ ุงุณุช ู ูพุงุณุฎโุฏู ุจูุงุฏุฑูฺฏ ุฑุง ุบุฑููฺฉู ูโุณุงุฒุฏ.

**ุฑุงูโุญู: ูพุงฺฏุงู ุฏุงุฏูโูุง ุจุฑุฏุงุฑ**
ุงู ูพุงฺฏุงูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ููุงูโูุง (Indexes) ูฺู ู ุงูฺฏูุฑุชูโูุง **ุฌุณุชุฌู ุชูุฑุจ ูุฒุฏฺฉโุชุฑู ููุณุงู (ANN)**ุ ูุถุง ุฌุณุชุฌู ุฑุง ุจููู ฺฉุฑุฏู ู ุงูฺฉุงู ุงูุชู ูุฒุฏฺฉโุชุฑู ูุชุงุฌ ุฑุง ุฏุฑ ฺฉุณุฑ ุงุฒ ุซุงูู ู ุฏุฑ ูุงู ููุงุฑุฏูุง ุฏุงุฏู ูุฑุงูู ูโฺฉููุฏ. ุฏุฑ ุงู ุณุณุชูโูุงุ ุจู ุณุฑุนุช ู ุฏูุช ฺฉ **ูุจุงุฏูู (Trade-off)** ูุฌูุฏ ุฏุงุฑุฏ.

**ูุจุงู ูู: ุจุฑุฏุงุฑูุงุ ุชุนุจู ู ุฌุณุชุฌู ูุนูุง**
*   **ุจุฑุฏุงุฑ (Vector):** ููุงุด ุนุฏุฏ ุฏุงุฏู (ฺฉ ฺฉูููุ ุชุตูุฑ ุง ุณูุฏ) ุจู ุตูุฑุช ฺฉ ูุณุช ุงุฒ ุงุนุฏุงุฏ. ฺฉุงููพูุชุฑูุง ุงุฒ ุงู ุทุฑู ูโุชูุงููุฏ ุฏุงุฏูโูุง ุฑุง ุฏุฑฺฉ ู ููุงุณู ฺฉููุฏ.
*   **ุชุนุจู (Embedding):** ูุฑุขูุฏ ุชุจุฏู ุฏุงุฏู ุจู ุจุฑุฏุงุฑ. ุงู ุจุฑุฏุงุฑูุง ุจู ฺฏูููโุง ุงุฌุงุฏ ูโุดููุฏ ฺฉู ุฏุงุฏูโูุง ูุดุงุจู ุงุฒ ูุธุฑ ูุนูุง (ูุงููุฏ "ูพุงุฏุดุงู" ู "ููฺฉู") ุฏุฑ ูุถุง ุจุฑุฏุงุฑ ุจู ฺฉุฏฺฏุฑ ูุฒุฏฺฉ ุจุงุดูุฏ.
*   **ุฌุณุชุฌู ูุนูุง:** ุจู ุฌุง ุชุทุงุจู ฺฉููู ฺฉูุฏุ ุจู ุฏูุจุงู ุฏุฑฺฉ **ููุธูุฑ ู ููููู** ูพุฑุณโูุฌู ุงุณุช (ูุซูุงู ุชุดุฎุต ุงูฺฉู "ูพุงุชูู" ุฏุฑ ฺฉ ูุชู ุจุฑูุงููโููุณ ุจู ูุงุฑ ุงุดุงุฑู ูุฏุงุฑุฏ).

**ูุนุงุฑูุง ุณูุฌุด ุดุจุงูุช**
ุจุฑุง ููุงุณู ุจุฑุฏุงุฑูุง ุงุฒ ูุนุงุฑูุง ุฑุงุถ ูุฎุชูู ุงุณุชูุงุฏู ูโุดูุฏุ ุงุฒ ุฌููู:
*   **ุดุจุงูุช ฺฉุณููุณ:** ุฒุงูู ุจู ุฏู ุจุฑุฏุงุฑ ุฑุง ุงูุฏุงุฒู ูโฺฏุฑุฏ (ููุฏุงุฑ ฑ ุจู ูุนูุง ุดุจุงูุช ฺฉุงูู).
*   **ูุงุตูู ุงููุฏุณ:** ูุงุตูู ูุณุชูู ุจู ุฏู ููุทู ุฑุง ุงูุฏุงุฒู ูโฺฏุฑุฏ (ููุฏุงุฑ ฐ ุจู ูุนูุง ุดุจุงูุช ฺฉุงูู).

**ูพุงฺฏุงูโูุง ุฏุงุฏู ุจุฑุฏุงุฑ ูุญุจูุจ**
ุจุฑุฎ ุงุฒ ฺฏุฒููโูุง ุดูุงุฎุชูโุดุฏู ุนุจุงุฑุชูุฏ ุงุฒ:
*   **Pinecone:** ฺฉ ุณุฑูุณ ฺฉุงููุงู ูุฏุฑุชโุดุฏู ู ฺฉุงุฑุจุฑูพุณูุฏ.
*   **Milvus:** ฺฉ ูพุงฺฏุงู ุฏุงุฏู ููุจุนโุจุงุฒ ู ุจุณุงุฑ ููุงุณโูพุฐุฑ.
*   **Weaviate:** ูพุงฺฏุงู ุฏุงุฏู ููุจุนโุจุงุฒ ุจุง ูุงุจูุช ุฌุณุชุฌู ุชุฑฺฉุจ (ุจุฑุฏุงุฑ ู ฺฉูููโฺฉูุฏ).
*   **Chroma:** ุณุงุฏู ู ุจูููโุดุฏู ุจุฑุง ุจุฑูุงููโูุง ูุจุชู ุจุฑ ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLM).
*   **FAISS:** ฺฉ ฺฉุชุงุจุฎุงูู ุจูููโุดุฏู ุชูุณุท ูุชุง ุจุฑุง ุฌุณุชุฌู ุดุจุงูุช.

**ููุงุฑุฏ ุงุณุชูุงุฏู ฺฉูุฏ**
*   **ุนูุงูู ูฺฉุงูููโุง (Chatbots):** ุฐุฎุฑูโุณุงุฒ ู ุจุงุฒุงุจ ุญุงูุธู ุจููุฏูุฏุช ูฺฉุงููุงุช ุจุฑุง ูพุงุณุฎโุฏู ูุชู.
*   **ุณุณุชูโูุง ุชูุตูโฺฏุฑ:** ูพุดููุงุฏ ูุญุตููุงุชุ ูููโูุง ุง ููุณู ูุดุงุจู ุจุฑ ุงุณุงุณ ุนูุงู ฺฉุงุฑุจุฑ.
*   **ุฌุณุชุฌู ูุนูุง:** ุงูุชู ุงุณูุงุฏ ู ูุญุชูุง ูุฑุชุจุท ุจุฑ ุงุณุงุณ ูููููุ ูู ฺฉููู ฺฉูุฏ.
*   **ุฌุณุชุฌู ุชุตูุฑ ู ูุฏู:** ุงูุชู ูุญุชูุง ุจุตุฑ ูุดุงุจู.

**ฺุงูุดโูุง**
*   **ุชุนุงุฏู ุณุฑุนุช ู ุฏูุช:** ุงูฺฏูุฑุชูโูุง ุชูุฑุจ ููฺฉู ุงุณุช ููุดู ุฏููโุชุฑู ูุชุฌู ุฑุง ุจุฑูฺฏุฑุฏุงููุฏ.
*   **ูุฒูู ู ููุงุจุน:** ูพุฑุฏุงุฒุด ุจุฑุฏุงุฑูุง ุจุง ุงุจุนุงุฏ ุจุงูุง ุจู ุณุฎุชโุงูุฒุงุฑ ูุฏุฑุชููุฏ ูุงุฒ ุฏุงุฑุฏ.
*   **ุงุฏุบุงู ุจุง ุณุณุชูโูุง ุณูุช:** ฺฉูพุงุฑฺูโุณุงุฒ ุจุง ูพุงฺฏุงูโูุง ุฏุงุฏู ุฑุงุจุทูโุง ููุฌูุฏ ูโุชูุงูุฏ ูพฺุฏู ุจุงุดุฏ.

**ุฌูุนโุจูุฏ ููุง**
ูพุงฺฏุงูโูุง ุฏุงุฏู ุจุฑุฏุงุฑ ุจุง ุงูฺฉุงู **ุฐุฎุฑูโุณุงุฒ ู ุฌุณุชุฌู ููุดููุฏ** ุจุฑ ุงุณุงุณ ูุนูุง ู ุดุจุงูุชุ ุฒุฑุณุงุฎุช ุถุฑูุฑ ุจุฑุง ูุณู ุฌุฏุฏ ุจุฑูุงููโูุง ููุด ูุตููุน ูุณุชูุฏ. ุขูโูุง ุจุง ุญู ูุดฺฉู ฺฉุงุฑ ุจุง ุฏุงุฏูโูุง ุญุฌู ู ุจุฏูู ุณุงุฎุชุงุฑุ ุฏูุง ุชุนุงูู ุจุง ูุงุดู ุฑุง ูุชุญูู ฺฉุฑุฏูโุงูุฏ.


## ูุดฺฉู ุงุตู ฺฉู FAISS ุญู ูโฺฉูุฏ
ููุช ุจุง ุฏุงุฏูโูุง ุจุฑุฏุงุฑ (Vector Data) ฺฉุงุฑ ูโฺฉูุฏ - ูุงููุฏ:
- ุงูุจุฏูฺฏโูุง ูุชู
- ุงูุจุฏูฺฏโูุง ุชุตูุฑ
- ุงูุจุฏูฺฏโูุง ุตูุช

ุฌุณุชุฌู ูุณุชูู ู ููุงุณู ุชูุงู ุจุฑุฏุงุฑูุง ุจุง ฺฉุฏฺฏุฑ ุจู ุฏูู **ูุดฺฉู ููุงุณโูพุฐุฑ** ุจุณุงุฑ ฺฉูุฏ ุงุณุช. FAISS ุงู ูุดฺฉู ุฑุง ุญู ูโฺฉูุฏ.

## ฺฺฏููู ฺฉุงุฑ ูโฺฉูุฏุ

### ุงูฺฏูุฑุชูโูุง ุงุตู
1. **ุงูุฏฺฉุณ ฺฉุฑุฏู** (Indexing):
   - ุจุฑุฏุงุฑูุง ุฑุง ุฏุฑ ุณุงุฎุชุงุฑูุง ุจูููโุดุฏู ุฐุฎุฑู ูโฺฉูุฏ
   - ุงุฒ ุชฺฉูฺฉโูุง ูุงููุฏ **ฺฉูุงูุชุฒุงุณูู** (Quantization) ุจุฑุง ูุดุฑุฏูโุณุงุฒ ุงุณุชูุงุฏู ูโฺฉูุฏ

2. **ุฌุณุชุฌู ุณุฑุน**:
   - ุงุฒ ุงูฺฏูุฑุชูโูุง ูุงููุฏ **IVF** (Inverted File Index)
   - **HNSW** (Hierarchical Navigable Small World)
   - **ูุญุงุณุจู ูุงุตูู** (Distance Calculation) ุจูููโุดุฏู

## ุงููุงุน ุงูุฏฺฉุณ ุฏุฑ FAISS

### ูพุงูโุง
- **IndexFlatL2**: ุฌุณุชุฌู ุฏูู ุจุง ูุงุตูู ุงููุฏุณ
- **IndexFlatIP**: ุฌุณุชุฌู ุฏูู ุจุง ุถุฑุจ ุฏุงุฎู

### ุจูููโุดุฏู ุจุฑุง ุญุงูุธู
- **IndexIVFFlat**: ุชุฑฺฉุจ ุฌุณุชุฌู ุชูุฑุจ ู ุฏูู
- **IndexPQ**: ูุดุฑุฏูโุณุงุฒ ูพุดุฑูุชู ุจุง Product Quantization

### ุชุฑฺฉุจ
- **IndexIVFPQ**: ุชุฑฺฉุจ IVF ู PQ ุจุฑุง ฺฉุงุฑุง ุจุงูุงุชุฑ

## ูุตุจ ู ุฑุงูโุงูุฏุงุฒ

```bash
# ุจุฑุง CPU
pip install faiss-cpu

# ุจุฑุง GPU (ุงฺฏุฑ ฺฉุงุฑุช ฺฏุฑุงูฺฉ ุฏุงุฑุฏ)
pip install faiss-gpu
```

## ูุซุงู ุนูู ุณุงุฏู

```python
import faiss
import numpy as np

# ุชููุฏ ุฏุงุฏูโูุง ููููู
dimension = 128  # ุจุนุฏ ุจุฑุฏุงุฑูุง
num_vectors = 10000

# ุชููุฏ ุจุฑุฏุงุฑูุง ุชุตุงุฏู
vectors = np.random.random((num_vectors, dimension)).astype('float32')

# ุงุฌุงุฏ ุงูุฏฺฉุณ
index = faiss.IndexFlatL2(dimension)

# ุงูุฒูุฏู ุจุฑุฏุงุฑูุง ุจู ุงูุฏฺฉุณ
index.add(vectors)

# ุฌุณุชุฌู ูุดุงุจูโุชุฑู ุจุฑุฏุงุฑูุง
query_vector = np.random.random((1, dimension)).astype('float32')
k = 5  # ุชุนุฏุงุฏ ูุชุงุฌ
distances, indices = index.search(query_vector, k)

print("ูุดุงุจูโุชุฑู ุจุฑุฏุงุฑูุง:", indices)
print("ูุงุตููโูุง:", distances)
```

## ฺฉุงุฑุจุฑุฏูุง ุงุตู

### 1. ุณุณุชูโูุง RAG (Retrieval-Augmented Generation)
- ุจุงุฒุงุจ ุงุณูุงุฏ ูุฑุชุจุท ุจุฑุง ูุฏูโูุง ุฒุจุงู
- ุจูุจูุฏ ุฏูุช ูพุงุณุฎโูุง ChatGPT-like

### 2. ุฌุณุชุฌู ุชุตูุฑ
- ูพุฏุง ฺฉุฑุฏู ุชุตุงูุฑ ูุดุงุจู
- ุณุณุชูโูุง ุชูุตูโฺฏุฑ ุจุตุฑ

### 3. ุฌุณุชุฌู ูุชู
- ูพุฏุง ฺฉุฑุฏู ุงุณูุงุฏ ูุดุงุจู
- ุชุดุฎุต ูุญุชูุง ุชฺฉุฑุงุฑ

### 4. ุณุณุชูโูุง ุชูุตูโฺฏุฑ
- ูพุฏุง ฺฉุฑุฏู ุขุชูโูุง ูุดุงุจู
- ุชูุตูโูุง ุดุฎุตโุดุฏู

## ูุฒุงุง ฺฉูุฏ

### โ **ุณุฑุนุช ุจุณุงุฑ ุจุงูุง**
- ุจูููโุดุฏู ุจุฑุง ูพุฑุฏุงุฒุด ููุงุฒ
- ูพุดุชุจุงู ุงุฒ GPU ุจุฑุง ุณุฑุนุช ุจุดุชุฑ

### โ **ููุงุณโูพุฐุฑ**
- ุชูุงูุง ูุฏุฑุช ููููโูุง ุจุฑุฏุงุฑ
- ุงุณุชูุงุฏู ุจููู ุงุฒ ุญุงูุธู

### โ **ุงูุนุทุงูโูพุฐุฑ**
- ูพุดุชุจุงู ุงุฒ ุงููุงุน ุงูฺฏูุฑุชูโูุง ุฌุณุชุฌู
- ูุงุจู ุชูุธู ุจุฑุง ูุงุฒูุง ูุฎุชูู

### โ **ุณุงุฏฺฏ ุงุณุชูุงุฏู**
- API ุชูุฒ ู ูุณุชูุฏุงุช ุฎูุจ
- ุฌุงูุนู ฺฉุงุฑุจุฑ ูุนุงู

## ูุนุงุจ ู ูุญุฏูุฏุชโูุง

### โ **ููุท ุฐุฎุฑูโุณุงุฒ ุฏุฑ ุญุงูุธู**
- ุฏุงุฏูโูุง ุจุง ุจุณุชู ุดุฏู ุจุฑูุงูู ุงุฒ ุจู ูโุฑููุฏ
- ูุงุฒ ุจู ูุฏุฑุช ุฌุฏุงฺฏุงูู ุจุฑุง ุฐุฎุฑูโุณุงุฒ ูพุงุฏุงุฑ

### โ **ุนุฏู ูพุดุชุจุงู ุงุฒ ูุชุงุฏุชุง**
- ููุท ุจุฑุฏุงุฑูุง ุฑุง ุฐุฎุฑู ูโฺฉูุฏ
- ุจุฑุง ุฐุฎุฑู ุงุทูุงุนุงุช ุงุถุงู ูุงุฒ ุจู ุฑุงูโุญู ุฌุงูุจ ุฏุงุฑุฏ

### โ **ูุฏุฑุช ุฏุณุช**
- ูุงุฒ ุจู ุจุฑูุฒุฑุณุงู ุฏุณุช ุงูุฏฺฉุณ
- ุนุฏู ูุฌูุฏ ูุงุจูุชโูุง ุฎูุฏฺฉุงุฑ

## ููุงุณู ุจุง ุณุงุฑ ุงุจุฒุงุฑูุง

| ุงุจุฒุงุฑ | ููุน | ุจูุชุฑู ุงุณุชูุงุฏู |
|-------|-----|----------------|
| **FAISS** | ฺฉุชุงุจุฎุงูู | ูููููโุณุงุฒ ุณุฑุนุ ฺฉุงุฑุจุฑุฏูุง ุฎุงุต |
| **Pinecone** | ุณุฑูุณ ุงุจุฑ | ุชููุฏุ ููุงุณ ุจุฒุฑฺฏ |
| **Weaviate** | ุฏุชุงุจุณ ุจุฑุฏุงุฑ | ุจุฑูุงููโูุง ฺฉุงูู ุจุง ูุชุงุฏุชุง |
| **Chroma** | ุฏุชุงุจุณ ุจุฑุฏุงุฑ | ูพุฑูฺูโูุง ุณุงุฏู ุชุง ูุชูุณุท |

## ุฌูุนโุจูุฏ ููุง

FAISS ฺฉ **ุงุจุฒุงุฑ ุชุฎุตุต ู ูููโุงูุนุงุฏู ฺฉุงุฑุขูุฏ** ุจุฑุง:
- ุชูโูุง ุชุญููุงุช
- ูููููโุณุงุฒ ุณุฑุน
- ฺฉุงุฑุจุฑุฏูุง ุฎุงุต ุจุง ูุงุฒ ุจู ุนููฺฉุฑุฏ ุจุงูุง

ุงูุง ุจุฑุง **ุจุฑูุงููโูุง ุชููุฏ ุฏุฑ ููุงุณ ุจุฒุฑฺฏ**ุ ููฺฉู ุงุณุช ูุงุฒ ุจู ุฑุงูโุญูโูุง ฺฉุงููโุชุฑ ูุงููุฏ ุฏุชุงุจุณโูุง ุจุฑุฏุงุฑ ุชุฎุตุต ุฏุงุดุชู ุจุงุดุฏ.


## ุขุฒูุงุด
**ุจุฑุง ุงูุฌุงู ุงู ุขุฒูุงุด ุงุจุชุฏุง ุจุงุฏ ูพุงุชูู ฺฏููู 3.12 ุฏุงุดุชู ุจุงุดุฏ ุจุง ุจุงูุงุชุฑ ุงุฒ ุขู ุฏฺุงุฑ ุจุญุฑุงู! ู ุดูุฏ**

### ูุญุท ุฌุฏุฏ
python -m venv "torch_env_fixed"

### ูุนุงู ฺฉุฑุฏู
torch_env_fixed\Scripts\activate

### ูุตุจ ูุง 

If youโre on CPU:

pip install faiss-cpu

If you have a CUDA GPU:

pip install faiss-gpu

pip install sentence_transformers

ุญุงูุง ุงููู ุชุจุฏู ูุชู ุจู ุจุฑุฏุงุฑ

```python
from sentence_transformers import SentenceTransformer

# Load embedding model
model = SentenceTransformer("sentence-transformers/all-MiniLM-L6-v2")

docs = [
    "The capital of France is Paris.",
    "Machine learning is a subset of AI.",
    "The Mona Lisa is in the Louvre."
]

# Encode documents into vectors
embeddings = model.encode(docs, convert_to_numpy=True)
```

output:
[[ 0.10325696  0.03042014  0.02909579 ...  0.05853157  0.08585992
  -0.0056698 ]
 [-0.03637548 -0.02661065  0.06555219 ...  0.05287919  0.06833272
  -0.06037488]
 [ 0.00113731 -0.04676315  0.00223458 ...  0.01240106  0.0471148
  -0.06059993]]

```python
import faiss
import numpy as np

# Create a FAISS index
dim = embeddings.shape[1]  # vector dimension
index = faiss.IndexFlatL2(dim)  # L2 distance
index.add(embeddings)  # add vectors to the index

print("Number of vectors in index:", index.ntotal)
```

output: Number of vectors in index: 3

## ุฌุณุชุฌู 2-NN

```python 
query = "Where is the Mona Lisa located?"
query_vec = model.encode([query], convert_to_numpy=True)

# Search top-2 results
k = 2
distances, indices = index.search(query_vec, k)

for i, idx in enumerate(indices[0]):
    print(f"Result {i+1}: {docs[idx]} (distance={distances[0][i]:.4f})")
```

output is:
Result 1: The Mona Lisa is in the Louvre. (distance=0.3544)
Result 2: The capital of France is Paris. (distance=1.5152)

### **ูุฑุญูู ต: ุงูุฒูุฏู ุจุงุฒุงุจ (Retriever) ุจู ูุนูุงุฑ RAG**

* FAISS ุชููุง ููุด ุจุงุฒุงุจ ุฑุง ุงูุง ูโฺฉูุฏ.
* ุดูุง ุขู ุฑุง ุจู ฺฉ ูุฏู ูููุฏ (ูุงููุฏ gpt-neo, llama.cpp ุง ฺฉ ูุฑุงุฎูุงู API ุจู OpenAI/Gemini) ูุชุตู ูโฺฉูุฏ ุชุง ุฎุท ูููู ฺฉุงูู RAG ุดฺฉู ุจฺฏุฑุฏ:

  ฑ. ฺฉุงุฑุจุฑ ุณูุงู ูโูพุฑุณุฏ.
  ฒ. ุจุงุฒุงุจ ุงุณูุงุฏ ุจุฑุชุฑ (top-k) ุจุง FAISS.
  ณ. ุงูุญุงู ุงุณูุงุฏ + ุณูุงู โ ูุฑูุฏ ุจู ูุฏู ุฒุจุงู ุจุฒุฑฺฏ (LLM).

### ูุซุงู

  ```python 
  retrieved_docs = [docs[idx] for idx in indices[0]]
context = "\n".join(retrieved_docs)

prompt = f"Answer the question using the context:\n\n{context}\n\nQuestion: {query}"
print(prompt)
```

output is:
Answer the question using the context:

The Mona Lisa is in the Louvre.
The capital of France is Paris.

Question: Where is the Mona Lisa located?



## ุขูฺู ุจุงุฏ ุงุฒ FAISS ู Transformer ุจู ุฒุจุงู ุณุงุฏู ุจุฏุงูู

**ุชุดุจู ุณุงุฏู**

### Transformer
- **ฺฉ ูุชุฑุฌู ูุชุฎุตุต** ฺฉู ูุชู ุฑุง ุจู "ุฒุจุงู ุฑุงุถ" ุชุฑุฌูู ูโฺฉูุฏ
- **ุฏุฑฺฉ ูุนูุง**: ูุชู ุฑุง ุจู ุจุฑุฏุงุฑูุง ุนุฏุฏ ุชุจุฏู ูโฺฉูุฏ
- **ุญูุธ ูุนูุง**: ุจุฑุฏุงุฑูุง ูุนูุง ูุชู ุฑุง ุญูุธ ูโฺฉููุฏ
- **ุชุดุงุจู ูุนูุง**: ูุชูู ูุดุงุจูุ ุจุฑุฏุงุฑูุง ูุฒุฏฺฉ ุฏุงุฑูุฏ
- **ุฏุฑฺฉ ุธุฑุงูุชโูุง ุฒุจุงู**

### FAISS  
- **ฺฉ ฺฉุชุงุจุฏุงุฑ ูููโุณุฑุน** ฺฉู ูโุฏุงูุฏ ูุฑ ฺฉุชุงุจ (ุจุฑุฏุงุฑ) ฺฉุฌุง ฺฉุชุงุจุฎุงูู ูุฑุงุฑ ุฏุงุฑุฏ
- **ุฌุณุชุฌู ุณุฑุน**: ุจุฑุฏุงุฑูุง ูุดุงุจู ุฑุง ุณุฑุน ูพุฏุง ูโฺฉูุฏ
- **ุจุฏูู ุฏุฑฺฉ ูุนูุง**: ููโูููุฏ ฺู ฺุฒ ุดุจู ฺุณุช!

## โจ ููุด ุฏูู FAISS

### ฑ. ูพุงฺฏุงู ุฏุงุฏู ุจูููโุดุฏู ุจุฑุง ุจุฑุฏุงุฑูุง
### ฒ. ููุงุณโูพุฐุฑ ุจุง ุฏุงุฏูโูุง ุจุฒุฑฺฏ  
### ณ. ุงููุงุน ุงูฺฏูุฑุชูโูุง ุจูููโุดุฏู

## โก ููุงุณู ุณุฑุนุช

### ุจุง FAISS:
- ุจุฑุง ฑ,ฐฐฐ,ฐฐฐ ุณูุฏ โ ~ฑฐฐ-ฑฐฐฐ ูุญุงุณุจู ูุงุตูู
- **ฑฐฐฐx ุณุฑุนโุชุฑ!**

## ๐ ุงููุงุน Index ุฏุฑ FAISS

| ููุน Index | ฺฉุงุฑุจุฑุฏ | ุณุฑุนุช | ุฏูุช |
|-----------|--------|------|------|
| `IndexFlatL2` | ุฏุงุฏูโูุง ฺฉูฺฺฉ | ูุชูุณุท | ฑฐฐูช |
| `IndexIVFFlat` | ุฏุงุฏูโูุง ูุชูุณุท | ุณุฑุน | ุจุงูุง |
| `IndexIVFPQ` | ุฏุงุฏูโูุง ุจุฒุฑฺฏ | ุจุณุงุฑ ุณุฑุน | ุฎูุจ |
| `IndexHNSW` | ุฏุงุฏูโูุง ุฎู ุจุฒุฑฺฏ | ูููโุณุฑุน | ุนุงู |

## ๐๏ธ ูุนูุงุฑ RAG ฺฉุงูู

### ูุฑุญูู ต: ุงูุฒูุฏู ุจุงุฒุงุจ (Retriever) ุจู ูุนูุงุฑ RAG

- FAISS ุชููุง ููุด **ุจุงุฒุงุจ** ุฑุง ุงูุง ูโฺฉูุฏ
- ุขู ุฑุง ุจู ฺฉ ูุฏู ูููุฏ ูุชุตู ูโฺฉูุฏ ุชุง ุฎุท ูููู ฺฉุงูู RAG ุดฺฉู ุจฺฏุฑุฏ

### ูุฑุงุญู ฺฉุงุฑ:

ฑ. **ฺฉุงุฑุจุฑ ุณูุงู ูโูพุฑุณุฏ**
ฒ. **ุจุงุฒุงุจ ุงุณูุงุฏ ุจุฑุชุฑ (top-k) ุจุง FAISS**  
ณ. **ุงูุญุงู ุงุณูุงุฏ + ุณูุงู โ ูุฑูุฏ ุจู ูุฏู ุฒุจุงู ุจุฒุฑฺฏ (LLM)**

## ๐ฏ ุฌูุนโุจูุฏ ููุง

### FAISS = ุณุณุชู ุจุงุฒุงุจ ุงุทูุงุนุงุช ุจุฑุง ุจุฑุฏุงุฑูุง

- **ูุฑูุฏ**: ุจุฑุฏุงุฑ ุฌุณุชุฌู
- **ุฎุฑูุฌ**: ูุฒุฏฺฉโุชุฑู ุจุฑุฏุงุฑูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู  
- **ูุฒุช**: ุณุฑุนุช ู ููุงุณโูพุฐุฑ
- **ุฌุงฺฏุงู**: ุจู ุชุฑูุณููุฑูุฑ (ุฏุฑฺฉ ูุนูุง) ู LLM (ุชููุฏ ูพุงุณุฎ)

### Transformer = ููู ูุนูุง  
### FAISS = ุฌุณุชุฌู ุณุฑุน

**ุจุฏูู FAISSุ RAG ุจุฑุง ุฏุงุฏูโูุง ูุงูุน ุบุฑุนูู ูโุดูุฏ!**

